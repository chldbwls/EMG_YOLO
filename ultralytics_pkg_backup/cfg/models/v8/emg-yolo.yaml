nc: 2           

depth_multiple: 0.33
width_multiple: 0.25

# -----------------------------
# Backbone
# -----------------------------
backbone:
  - [ -1, 1, Conv,       [64, 3, 2] ]
  - [ -1, 1, Conv,       [128, 3, 2] ]
  - [ -1, 3, C2fEMCM,    [128, True] ]  
  - [ -1, 1, Conv,       [256, 3, 2] ]
  - [ -1, 6, C2fEMCM,    [256, True] ]
  - [ -1, 1, Conv,       [512, 3, 2] ]
  - [ -1, 6, C2fEMCM,    [512, True] ]
  - [ -1, 1, SPPF,       [512, 5] ]

# -----------------------------
# Head
# -----------------------------
head:
  # P5 → P4
  - [ -1, 1, Conv,       [256, 1, 1] ]
  - [ -1, 1, nn.Upsample,[None, 2, 'nearest'] ]
  - [ [ -1, 6 ], 1, Concat, [1] ]      
  - [ -1, 3, C2fEMCM,    [256] ]       

  # P4 → P3
  - [ -1, 1, Conv,       [128, 1, 1] ]
  - [ -1, 1, nn.Upsample,[None, 2, 'nearest'] ]
  - [ [ -1, 4 ], 1, Concat, [1] ]        
  - [ -1, 3, C2fEMCM,    [128] ]

  # P3 → P4 (down)
  - [ -1, 1, Conv,       [128, 3, 2] ]
  - [ [ -1, 14 ], 1, Concat, [1] ]
  - [ -1, 3, C2fEMCM,    [256] ]

  # P4 → P5 (down)
  - [ -1, 1, Conv,       [256, 3, 2] ]
  - [ [ -1, 10 ], 1, Concat, [1] ]
  - [ -1, 3, C2fEMCM,    [512] ]

  # Detect head
  - [ [ 17, 20, 23 ], 1, Detect, [nc] ]
